(function(){"use strict";function g({width:e}){return function(n,r){return(r*e+n)*4}}const C=(e,t,n,r,o)=>{const i=g(e),s=g(t),a=t.width*t.height;let h=0,v=0,_=0,P=0,b=0;for(let u=0,D=t.height;u<D;u++)for(let f=0,H=t.width;f<H;f++){const m=o(e,i(n+f,r+u)),y=o(t,s(f,u));h+=m**2,v+=m,_+=y**2,P+=y,b+=m*y}const E=v/a,T=P/a,G=b/a,I=h/a,R=_/a,q=G-E*T,z=I-E**2,B=R-T**2,S=Math.sqrt(z)*Math.sqrt(B);return S===0?1:q/S},x=(e,t)=>e.data[t]*.3+e.data[t+1]*.59+e.data[t+2]*.11;function*M(e,t,n,r){for(let o=n;o<r;++o)for(let i=e;i<t;++i)yield{pos:{x:i,y:o},meta:{}}}function*F(e,t){yield*M(t.offsetX,e.width+-t.originW,t.offsetY,e.height+-t.originH)}function A(e){const t=e.at(-1);if(t===void 0)throw new Error("something wrong: last takes zero scores");return t}var p=function(e,t,n,r,o){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?o.call(e,n):o?o.value=n:t.set(e,n),n},d=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},c,l,w;class j{constructor(t=A){c.set(this,null),l.set(this,-1/0),w.set(this,void 0),p(this,w,t,"f")}retrieve(t,n){var r,o;const i=d(this,w,"f").call(this,((r=t.meta.scores)!==null&&r!==void 0?r:[]).concat(n));if(i>d(this,l,"f")){const s=structuredClone(t),a=(o=s.meta.scores)!==null&&o!==void 0?o:[];a.push(i),s.meta.scores=a,p(this,l,i,"f"),p(this,c,s,"f")}}first(){if(d(this,c,"f")===null)throw new Error("something wrong: result is null");return structuredClone(d(this,c,"f"))}all(){return[this.first()]}}c=new WeakMap,l=new WeakMap,w=new WeakMap;function O(e,t,n,r,o,i){const s=i();for(const a of o()){const h=n(e,t,a.pos.x,a.pos.y,r);s.retrieve(a,h)}return s}function W(e,t,n,r,o=()=>new j){return O(e,t,n,r,()=>F(e,{offsetX:0,offsetY:0,originW:t.width,originH:t.height}),o).first().pos}onmessage=e=>{const{base:t,temp:n}=e.data,r=W(new ImageData(new Uint8ClampedArray(t.data),t.width,t.height),new ImageData(new Uint8ClampedArray(n.data),n.width,n.height),C,x);postMessage(r)}})();
